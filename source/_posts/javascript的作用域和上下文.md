---
title: javascript的作用域和上下文
date: 2019-02-17 23:43:44
tags: js
---

### 前言
今天在用es6的proxy实现观察者模式时遇到了一个自己感觉模棱两口的问题，仔细一想也就是变量的作用域到底是取决于定义时还是运行时？在自己理解的过程中，于是就有了这篇文章。

### 作用域
概念上说它是指变量，函数，对象在特定区域下的可访问性。
概念都是比较抽象的东西，我们从头说起，js代码到浏览器运行要经过2个过程，编译------>运行。这恰恰对应这作用域和上下文2个概念。也就是说javascript的作用域在编译阶段就已经确定了，换句话来讲就是**作用域的范围取决于定义时的区域**。来个例子理解：

```
function foo1() {
    let name = 'test';
    foo2();
}
function foo2() {
    console.log(name);
}

foo1();  // 输出name is not defined
```
上面foo2函数寻找name的路径是：**foo2自身的函数作用域----->全局作用域**，2个作用域里都没有name变量，因此输出未定义。因此我们也可以发现寻找作用域链时的规律：**自身局部作用域----->自身定义时的作用域------>定义时的上层作用域------一直向上追溯。**
js是静态编译的，上面的name属性在foo1函数的局部作用域内，只在函数内部可以访问（闭包），即使foo2在foo1内运行，但它定义时在全局作用域，所以无法访问foo1局部作用域，这也就是上面总结的：作用域范围取决于定义时，一个变量的可访问性要看定义时的作用域及作用域链上是否存在该变量。
